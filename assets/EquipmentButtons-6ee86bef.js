import{I as $,_ as ee,R as ae,i as z,r as q,c as G,x as B,D as V,T as ne,d as W,o as i,l as E,z as S,f as a,g as p,t as A,k as C,L as te,e as u,F as I,j,h as D,q as se,s as le,u as oe,y as P}from"./index-094e1f23.js";import{I as ue}from"./ItemStatList-a42a6ba5.js";const ce=()=>{const f=h=>{let y=O(h),g="https://www.wakfu.com/en/mmorpg/encyclopedia",c="";return h.type.validSlots.includes($.FIRST_WEAPON.id)||h.type.validSlots.includes($.SECOND_WEAPON.id)?c=`${g}/weapons/${y}`:h.type.validSlots.includes($.PET.id)?c=`${g}/pets/${y}`:h.type.validSlots.includes($.MOUNT.id)?c=`${g}/mounts/${y}`:h.type.validSlots.includes($.ACCESSORY.id)?c=`${g}/accessories/${y}`:c=`${g}/armors/${y}`,c},O=h=>{let y=h.id,g=h.name.toLowerCase().replace(" ","-");return`${y}-${g}`};return{getItemEncyclopediaUrl:f}};const ie=f=>(se("data-v-eb02d5be"),f=f(),le(),f),re=ie(()=>a("div",{class:"drag-bar"},null,-1)),de={class:"edit-item-modal-content flex flex-column pb-2"},pe={class:"header-area flex px-3 pt-2 pb-1"},me={class:"flex flex-column ml-1"},ve={class:"item-name mr-2 truncate",style:{"max-width":"15ch"}},_e={class:"flex"},he={key:0},ye={key:1},ge=ie(()=>a("div",{class:"flex-grow-1"},null,-1)),fe={key:0,class:"random-mastery-section flex flex-column px-3"},ke={class:"text-center w-full text-lg mb-2 pt-2"},xe={class:"flex justify-content-center gap-2 px-3"},be={key:0,class:"flex align-items-center"},$e={key:1},Se={class:"flex align-items-center py-1 px-2"},we={class:"capitalize"},Ee={key:1,class:"random-resistance-section flex flex-column px-3"},Ae={class:"text-center w-full text-lg mb-2 pt-2"},Ce={class:"flex justify-content-center gap-2 px-3"},Ie={key:0,class:"flex align-items-center"},We={key:1},Oe={class:"flex align-items-center py-1 px-2"},qe={class:"capitalize"},Ne={class:"flex justify-content-center mt-2"},Re={__name:"EditEquipmentModal",setup(f,{expose:O}){let h=ae();const y=z("currentCharacter"),g=q(!1),c=q(null),o=q({}),k=[{value:"empty",label:"None",icon:"empty_coin"},{value:"water",label:"Water",icon:"water_coin"},{value:"earth",label:"Earth",icon:"earth_coin"},{value:"air",label:"Air",icon:"air_coin"},{value:"fire",label:"Fire",icon:"fire_coin"}],v=G(()=>{var t,e;return(e=(t=c.value)==null?void 0:t.equipEffects)==null?void 0:e.find(l=>l.id===1068)});B(v,()=>{V(()=>{N()})});const n=G(()=>{var t,e;return(e=(t=c.value)==null?void 0:t.equipEffects)==null?void 0:e.find(l=>l.id===1069)});B(n,()=>{V(()=>{R()})}),B(ne,()=>{N(),R()});const N=()=>{v.value!==void 0&&(o.value.masterySlot1=k.find(t=>{var e;return t.value===((e=v.value.masterySlot1)==null?void 0:e.type)}),o.value.masterySlot2=k.find(t=>{var e;return t.value===((e=v.value.masterySlot2)==null?void 0:e.type)}),o.value.masterySlot3=k.find(t=>{var e;return t.value===((e=v.value.masterySlot3)==null?void 0:e.type)}))},R=()=>{n.value!==void 0&&(o.value.resistanceSlot1=k.find(t=>{var e,l;return t.value===((l=(e=n.value)==null?void 0:e.resistanceSlot1)==null?void 0:l.type)}),o.value.resistanceSlot2=k.find(t=>{var e,l;return t.value===((l=(e=n.value)==null?void 0:e.resistanceSlot2)==null?void 0:l.type)}),o.value.resistanceSlot3=k.find(t=>{var e,l;return t.value===((l=(e=n.value)==null?void 0:e.resistanceSlot3)==null?void 0:l.type)}))},U=(t,e)=>{var _,s;let l=(s=(_=c.value)==null?void 0:_.equipEffects)==null?void 0:s.find(x=>x.id===1068);l[e]={type:o.value[e].value,value:v.value.values[0]},Object.keys(l).forEach(x=>{var m;x!==e&&((m=l[x])==null?void 0:m.type)===o.value[e].value&&(l[x]={type:k[0].value,value:[]},o.value[x]=k[0])})},T=()=>{Object.keys(o.value).forEach(t=>{var e,l;if(o.value[t]){let _=(l=(e=c.value)==null?void 0:e.equipEffects)==null?void 0:l.find(s=>s.id===1069);_[t]={type:o.value[t].value,value:n.value.values[0]}}})},M=()=>{Object.keys(y.value.equipment).forEach(t=>{y.value.equipment[t]!==null&&y.value.equipment[t].equipEffects.forEach(e=>{var l,_,s,x,m,r;e.id===1068&&v.value&&(e.values[2]>=1&&(e.masterySlot1={type:((l=o.value.masterySlot1)==null?void 0:l.value)||"empty",value:e.values[0]}),e.values[2]>=2&&(e.masterySlot2={type:((_=o.value.masterySlot2)==null?void 0:_.value)||"empty",value:e.values[0]}),e.values[2]>=3&&(e.masterySlot3={type:((s=o.value.masterySlot3)==null?void 0:s.value)||"empty",value:e.values[0]})),e.id===1069&&n.value&&(e.values[2]>=1&&(e.resistanceSlot1={type:((x=o.value.resistanceSlot1)==null?void 0:x.value)||"empty",value:e.values[0]}),e.values[2]>=2&&(e.resistanceSlot2={type:((m=o.value.resistanceSlot2)==null?void 0:m.value)||"empty",value:e.values[0]}),e.values[2]>=3&&(e.resistanceSlot3={type:((r=o.value.resistanceSlot3)==null?void 0:r.value)||"empty",value:e.values[0]}))})})},F=(t,e,l)=>{c.value=y.value.equipment[t],g.value=!0,V(()=>{let _=document.getElementById(h);_.style.position="fixed",_.style.left=`${e}px`,_.style.top=`${l}px`,N(),R()})},d=()=>{g.value=!1};return O({open:F}),(t,e)=>{const l=W("p-image"),_=W("p-button"),s=W("p-dropdown"),x=W("p-dialog");return i(),E(x,{id:C(h),visible:g.value,"onUpdate:visible":e[0]||(e[0]=m=>g.value=m)},{header:S(()=>[re]),default:S(()=>[a("div",de,[a("div",pe,[p(l,{src:`https://tmktahu.github.io/WakfuAssets/items/${c.value.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),a("div",me,[a("div",ve,A(c.value.name),1),a("div",_e,[p(l,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/rarities/${c.value.rarity}.png`,"image-style":"width: 12px;"},null,8,["src"]),p(l,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/itemTypes/${c.value.type.id}.png`,"image-style":"width: 18px;"},null,8,["src"]),C(te).includes(c.value.type.id)?(i(),u("div",he,"Item Level: 50")):(i(),u("div",ye,"Level: "+A(c.value.level),1))])]),ge,p(_,{class:"close-button px-1 py-1",icon:"mdi mdi-close-thick",onClick:d})]),v.value?(i(),u("div",fe,[a("div",ke,"+"+A(v.value.values[0])+" Mastery Assignment",1),a("div",xe,[(i(!0),u(I,null,j(v.value.values[2],m=>(i(),E(s,{key:m,modelValue:o.value["masterySlot"+m],"onUpdate:modelValue":r=>o.value["masterySlot"+m]=r,class:"mastery-dropdown",options:k,onChange:r=>U(r,"masterySlot"+m)},{value:S(r=>[r.value?(i(),u("div",be,[p(l,{src:`https://tmktahu.github.io/WakfuAssets/statistics/${r.value.icon}.png`,style:{height:"40px"},"image-style":"height: 40px; margin-top: -1px"},null,8,["src"])])):(i(),u("span",$e,[p(l,{src:"https://tmktahu.github.io/WakfuAssets/statistics/empty_coin.png",style:{height:"36px"},"image-style":"height: 36px; margin-top: 1px; margin-left: 2px"},null,8,["src"])]))]),option:S(r=>[a("div",Se,[a("div",we,A(r.option.label),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]))),128))])])):D("",!0),n.value?(i(),u("div",Ee,[a("div",Ae,"+"+A(n.value.values[0])+" Resistance Assignment",1),a("div",Ce,[(i(!0),u(I,null,j(n.value.values[2],m=>(i(),E(s,{key:m,modelValue:o.value["resistanceSlot"+m],"onUpdate:modelValue":r=>o.value["resistanceSlot"+m]=r,class:"mastery-dropdown",options:k,onChange:T},{value:S(r=>[r.value?(i(),u("div",Ie,[p(l,{src:`https://tmktahu.github.io/WakfuAssets/statistics/${r.value.icon}.png`,style:{height:"40px"},"image-style":"height: 40px; margin-top: -1px"},null,8,["src"])])):(i(),u("span",We,[p(l,{src:"https://tmktahu.github.io/WakfuAssets/statistics/empty_coin.png",style:{height:"36px"},"image-style":"height: 36px; margin-top: 1px; margin-left: 2px"},null,8,["src"])]))]),option:S(r=>[a("div",Oe,[a("div",qe,A(r.option.label),1)])]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))])])):D("",!0),a("div",Ne,[p(_,{class:"py-2",label:"Apply to all Items",onClick:M})])])]),_:1},8,["id","visible"])}}},Te=ee(Re,[["__scopeId","data-v-eb02d5be"]]);const L=f=>(se("data-v-4a4aea5b"),f=f(),le(),f),Me={class:"flex equipment-slots-wrapper"},je={key:0,class:"flex align-items-center justify-content-center"},De={key:1,class:"flex align-items-center justify-content-center"},Le={class:"flex align-items-center justify-content-center"},Be=L(()=>a("div",{class:"hover-icon search"},[a("i",{class:"pi pi-search"})],-1)),Ve={class:"flex align-items-center justify-content-center w-full",style:{position:"relative"}},Ue=["onClick"],Fe=L(()=>a("i",{class:"pi pi-pencil"},null,-1)),Pe=[Fe],ze=["onClick"],Ge=L(()=>a("i",{class:"pi pi-trash"},null,-1)),Ye=[Ge],He={key:0,class:"random-stat-icons-wrapper"},Je={key:1,class:"random-stat-icons-wrapper"},Qe={key:0,class:"item-card-tooltip"},Xe={class:"effect-header flex pt-2 px-1"},Ze={class:"flex flex-column"},Ke={class:"item-name mr-2"},et={class:"flex"},tt={key:0},st={key:1},lt=L(()=>a("div",{class:"flex-grow-1"},null,-1)),it={class:"flex"},at=L(()=>a("div",{class:"simple-tooltip"},"Open Encyclopedia Page",-1)),nt={__name:"EquipmentButtons",props:{character:{type:Object,default:()=>{}},readOnly:{type:Boolean,default:!1}},setup(f){let O=f;const h=oe(),{getItemEncyclopediaUrl:y}=ce(),g=z("itemFilters"),c=q(null),o=G(()=>{let d=v.value.equipment[$.FIRST_WEAPON.id];return d?!!d.type.disabledSlots.includes($.SECOND_WEAPON.id):!1}),k=z("masterData"),v=q(O.character),n=q({});B(k,()=>{V(()=>{var d;v.value=O.character,n.value=(d=v.value)==null?void 0:d.equipment})},{immediate:!0});const N=d=>{g.itemTypeFilters.forEach(t=>{t.validSlots.includes($[d])?t.checked=!0:t.checked=!1})},R=(d,t,e)=>{c.value[d].open(t,e.target.getBoundingClientRect().left-200,e.target.getBoundingClientRect().bottom+10)},U=(d,t)=>{h.require({group:"popup",target:t.currentTarget,message:"Are you sure?",accept:()=>{v.value.equipment[d]=null}})},T=d=>{var t;return((t=v.value.equipment[d])==null?void 0:t.equipEffects.find(e=>e.id===1068))||null},M=d=>{var t;return((t=v.value.equipment[d])==null?void 0:t.equipEffects.find(e=>e.id===1069))||null},F=d=>{let t=y(d);window.open(t,"_blank")};return(d,t)=>{const e=W("p-image"),l=W("p-button"),_=W("tippy");return i(),u("div",Me,[(i(!0),u(I,null,j(C($),(s,x,m)=>{var r,Y;return i(),u(I,{key:s.id},[f.readOnly?(i(),u("div",{key:0,class:P(["equipment-display",{"has-item":n.value[s.id]!==null}])},[(r=n.value[s.id])!=null&&r.imageId?(i(),u("div",je,[p(e,{src:`https://tmktahu.github.io/WakfuAssets/items/${(Y=n.value[s.id])==null?void 0:Y.imageId}.png`,"image-style":"width: 40px"},null,8,["src"])])):(i(),u("div",De,[p(e,{src:`https://tmktahu.github.io/WakfuAssets/equipmentDefaults/${s.id}.png`,"image-style":"width: 60px"},null,8,["src"])]))],2)):(i(),u(I,{key:1},[n.value[s.id]===null?(i(),E(l,{key:0,class:P(["equipment-button",{"has-item":n.value[s.id]!==null,disabled:s.id===C($).SECOND_WEAPON.id&&o.value}]),onClick:w=>N(s.id)},{default:S(()=>{var w;return[a("div",Le,[Be,s.id===C($).SECOND_WEAPON.id&&o.value?(i(),E(e,{key:0,class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/items/${(w=n.value[C($).FIRST_WEAPON.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),E(e,{key:1,class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/equipmentDefaults/${s.id}.png`,"image-style":"width: 60px"},null,8,["src"]))])]}),_:2},1032,["class","onClick"])):(i(),E(_,{key:1,placement:"bottom",interactive:""},{content:S(()=>{var w,b,H,J,Q,X,Z,K;return[n.value[s.id]?(i(),u("div",Qe,[a("div",Xe,[p(e,{src:`https://tmktahu.github.io/WakfuAssets/items/${(w=n.value[s.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),a("div",Ze,[a("div",Ke,A((b=n.value[s.id])==null?void 0:b.name),1),a("div",et,[p(e,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/rarities/${(H=n.value[s.id])==null?void 0:H.rarity}.png`,"image-style":"width: 12px;"},null,8,["src"]),p(e,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/itemTypes/${(Q=(J=n.value[s.id])==null?void 0:J.type)==null?void 0:Q.id}.png`,"image-style":"width: 18px;"},null,8,["src"]),C(te).includes((Z=(X=n.value[s.id])==null?void 0:X.type)==null?void 0:Z.id)?(i(),u("div",tt,"Item Level: 50")):(i(),u("div",st,"Level: "+A((K=n.value[s.id])==null?void 0:K.level),1))])]),lt,a("div",it,[p(_,{placement:"left"},{content:S(()=>[at]),default:S(()=>[p(l,{icon:"pi pi-question-circle",class:"equip-button",onClick:ot=>F(n.value[s.id])},null,8,["onClick"])]),_:2},1024)])]),p(ue,{item:n.value[s.id]},null,8,["item"])])):D("",!0)]}),default:S(()=>{var w;return[a("div",{class:P(["equipment-button",{"has-item":n.value[s.id]!==null}])},[a("div",Ve,[a("div",{class:"hover-icon edit",onClick:b=>R(m,s.id,b)},Pe,8,Ue),a("div",{class:"hover-icon remove",onClick:b=>U(s.id,b)},Ye,8,ze),p(e,{class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/items/${(w=n.value[s.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),T(s.id)!==null?(i(),u("div",He,[(i(!0),u(I,null,j(T(s.id).values[2],b=>(i(),E(e,{key:b,src:`https://tmktahu.github.io/WakfuAssets/statistics/${T(s.id)[`masterySlot${b}`].type}_coin.png`,"image-style":"width: 16px"},null,8,["src"]))),128))])):D("",!0),M(s.id)!==null?(i(),u("div",Je,[(i(!0),u(I,null,j(M(s.id).values[2],b=>(i(),E(e,{key:b,src:`https://tmktahu.github.io/WakfuAssets/statistics/${M(s.id)[`resistanceSlot${b}`].type}_coin.png`,"image-style":"width: 16px"},null,8,["src"]))),128))])):D("",!0)])],2)]}),_:2},1024)),p(Te,{ref_for:!0,ref_key:"editEquipmentModal",ref:c},null,512)],64))],64)}),128))])}}},rt=ee(nt,[["__scopeId","data-v-4a4aea5b"]]);export{rt as E,ce as u};
