(function(){"use strict";importScripts("https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js");let t=null,o=null,s=null,n=null,d=null,i=null;const r=async()=>{o=await loadPyodide(),await o.loadPackage("micropip");const e=o.pyimport("micropip");console.log("Installing msgspec"),await e.install("https://cdn.jsdelivr.net/gh/mikeshardmind/wakfu-utils@d4d24e1f631b5cf99ee1d9a7ee18bb8bd954fe9c/msgspec-0.18.4-cp311-cp311-emscripten_3_1_45_wasm32.whl"),console.log("Setting up the AutoBuild package loaded."),await e.install("wakautosolver"),console.log("AutoBuild package installed."),s=o.pyimport("wakautosolver"),console.log("AutoBuild package loaded."),postMessage("workerReady")},u=async()=>{var e;await p(n),(e=t==null?void 0:t[0])!=null&&e.length?g():postMessage(t[1])},p=async e=>{let l={lv:e.targetLevel,ap:e.targetApAmount,mp:e.targetMpAmount,wp:e.targetWpAmount,ra:e.targetRangeAmount,num_mastery:e.targetNumElements,dist:e.distanceMastery,melee:e.meleeMastery,zerk:e.berserkMastery,rear:e.rearMastery,heal:e.healingMastery,hard_cap_depth:7,bcrit:20};console.log("Python Params (useful for debugging if you need them)",l);let a=s.Config.callKwargs(l);t=s.solve_config(a)},g=()=>{let e=t[0],l=[];d.forEach(a=>{e.includes(a.id)&&l.push(a)}),l.sort((a,c)=>i.indexOf(a.type.validSlots[0])-i.indexOf(c.type.validSlots[0])),postMessage({items:l})};r(),onmessage=async e=>{n=e.data.params,d=e.data.itemData,i=e.data.ITEM_SLOT_SORT_ORDER,u()}})();
