import{_ as Q,u as X,a as Z,b as ee,c as te,i as se,r as ae,d as le,e as oe,f as R,g as h,o as c,h as v,j as s,t as u,k as o,l as re,w as _,m as C,C as I,v as ne,F as P,n as $,p as x,q as i,s as ce,x as ie}from"./index-b3b85fc6.js";import{E as A}from"./EquipmentButtons-078d1ed2.js";import{a as S}from"./addCompanion-f6ce7806.js";import"./ItemStatList-d7b40f73.js";const g=k=>(ce("data-v-e9011152"),k=k(),ie(),k),de={class:"flex flex-column flex-grow-1 ml-4 mr-3",style:{height:"100%",overflow:"hidden"}},ue={class:"mt-3",style:{"font-size":"42px"}},pe={class:"mt-2"},me={class:"flex align-items-center w-full"},he={class:"text-xl mr-3"},ve={key:0,class:"mt-2",style:{color:"var(--error)"}},_e={class:"character-area"},ge={class:"flex w-full"},fe={class:"text-xl"},ye=g(()=>s("div",{class:"flex-grow-1"},null,-1)),Ce={class:"character-enties-wrapper flex flex-column mt-2 pb-3"},xe=["onDrop"],ke=g(()=>s("i",{class:"mdi mdi-folder"},null,-1)),be={class:"flex"},we={class:"mx-2"},De=g(()=>s("i",{class:"mdi mdi-pencil"},null,-1)),Be={class:"px-3"},Ie=g(()=>s("div",{class:"flex-grow-1"},null,-1)),Pe=["onDrop"],$e=["onClick","onDragstart"],Te={class:"character-info flex align-items-center justify-content-left flex-grow-1"},Ve={class:"ml-3"},Ee={class:"class-name flex-grow-1 truncate"},Ne={class:"class-level"},Le={class:"character-items flex-grow-1"},Ue=g(()=>s("i",{class:"mdi mdi-folder"},null,-1)),Re=g(()=>s("div",{class:"mx-2"},"Ungrouped",-1)),Ae=g(()=>s("div",{class:"flex-grow-1"},null,-1)),Se=["onClick","onDragstart"],je={class:"character-info flex align-items-center justify-content-left flex-grow-1"},Fe={class:"ml-3"},Ge={class:"class-name flex-grow-1 truncate"},Oe={class:"class-level"},qe={class:"character-items flex-grow-1"},We={__name:"CharactersPage",setup(k){const j=X(),F=Z(),{t:T}=ee(),B=te(),n=se("masterData"),f=ae(""),{decodeBuildCode:G}=le(),{createNewCharacter:O,createNewCharacterFromCode:q,deleteCharacter:W}=oe(n),V=R(()=>G(f.value)!==null),z=R(()=>{let t=[];return n.groups.forEach(r=>{t.push(...r.buildIds)}),n.characters.filter(r=>!t.includes(r.id))}),E=t=>{let e=O();t.buildIds.push(e.id),B.push({name:I,params:{characterId:e.id}})},H=()=>{let t=q(f.value);B.push({name:I,params:{characterId:t.id}})},M=()=>{n.groups.push({id:ne(),name:T("charactersPage.newGroup"),buildIds:[]})},Y=t=>{if(t.buildIds.length===0){let e=n.groups.indexOf(t);n.groups.splice(e,1)}else j.add({severity:"error",summary:"You cannot delete a group that has characters in it.",life:3e3})},b=(t,e)=>{F.require({group:"popup",target:t.currentTarget,message:T("confirms.irreversable"),accept:()=>{n.groups.forEach(r=>{if(r.buildIds.includes(e)){let p=r.buildIds.indexOf(e);r.buildIds.splice(p,1)}}),W(e)}})},N=(t,e)=>{t.target.classList.contains("delete-button")||B.push({name:I,params:{characterId:e}})},y=t=>n.characters.find(e=>e.id===t),L=(t,e)=>{t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("buildId",e)},w=(t,e)=>{try{let r=t.dataTransfer.getData("buildId");n.groups.forEach(p=>{if(p.buildIds.includes(r)){let d=p.buildIds.indexOf(r);p.buildIds.splice(d,1)}}),e!=="none"&&e.buildIds.push(r)}catch{}};return(t,e)=>{const r=h("p-divider"),p=h("p-inputText"),d=h("p-button"),J=h("p-inplace"),D=h("p-image"),U=h("p-accordionTab"),K=h("p-accordion");return c(),v("div",de,[s("div",ue,u(t.$t("charactersPage.title")),1),s("div",pe,u(t.$t("charactersPage.description")),1),o(r),s("div",null,[s("div",me,[s("div",he,u(t.$t("charactersPage.codeInputLabel"))+":",1),o(p,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=a=>f.value=a),placeholder:t.$t("charactersPage.codeInputPlaceholder"),class:"flex-grow-1 py-2"},null,8,["modelValue","placeholder"]),o(d,{icon:"mdi mdi-plus-thick",disabled:!V.value,label:t.$t("charactersPage.codeInputButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:H},null,8,["disabled","label"])]),!V.value&&f.value!==""?(c(),v("div",ve,u(t.$t("charactersPage.invalidBuildCode")),1)):re("",!0)]),o(r),s("div",_e,[s("div",ge,[s("div",fe,u(t.$t("charactersPage.savedCharactersTitle")),1),ye,o(d,{icon:"mdi mdi-folder",label:t.$t("charactersPage.createNewGroupButton"),class:"create-character-button py-1 pr-3 pl-2",onClick:M},null,8,["label"])]),s("div",Ce,[o(K,{multiple:"","active-index":[...C(n).groups.keys(),C(n).groups.length]},{default:_(()=>[(c(!0),v(P,null,$(C(n).groups,a=>(c(),x(U,{key:a.id},{header:_(()=>[s("div",{class:"flex align-items-center w-full px-3 py-2",onDrop:l=>w(l,a),onDragover:e[2]||(e[2]=i(()=>{},["prevent"])),onDragenter:e[3]||(e[3]=i(()=>{},["prevent"]))},[ke,o(J,{closable:!0,pt:{content:{class:"flex align-items-center"},button:{class:"py-1"}},onClick:e[1]||(e[1]=i(()=>{},["stop"]))},{display:_(()=>[s("div",be,[s("div",we,u(a.name),1),De])]),content:_(()=>[s("div",Be,[o(p,{modelValue:a.name,"onUpdate:modelValue":l=>a.name=l,class:"py-1",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024),Ie,o(d,{icon:"mdi mdi-plus-thick",label:t.$t("charactersPage.createNewCharacterButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:i(l=>E(a),["stop"])},null,8,["label","onClick"]),o(d,{icon:"pi pi-trash",class:"ml-3 py-1",onClick:i(l=>Y(a),["stop"])},null,8,["onClick"])],40,xe)]),default:_(()=>[s("div",{onDrop:l=>w(l,a),onDragover:e[4]||(e[4]=i(()=>{},["prevent"])),onDragenter:e[5]||(e[5]=i(()=>{},["prevent"]))},[(c(!0),v(P,null,$(a.buildIds,l=>(c(),v("div",{key:l,class:"character-entry py-2 mt-2",draggable:"true",onClick:m=>N(m,l),onDragstart:m=>L(m,l)},[s("div",Te,[s("div",Ve,[y(l).class?(c(),x(D,{key:0,class:"class-image",src:`https://tmktahu.github.io/WakfuAssets/classes/${y(l).class}.png`,"image-style":"width: 40px"},null,8,["src"])):(c(),x(D,{key:1,class:"class-image",src:C(S),"image-style":"width: 40px"},null,8,["src"]))]),o(r,{class:"mx-2",layout:"vertical"}),s("div",Ee,u(y(l).name),1),o(r,{class:"mx-2",layout:"vertical"}),s("div",Ne,"Lvl "+u(y(l).level),1),o(r,{class:"mx-2",layout:"vertical"}),o(d,{class:"by-level-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:m=>b(m,l)},null,8,["onClick"])]),s("div",Le,[o(A,{character:y(l),"read-only":""},null,8,["character"])]),o(d,{class:"at-end-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:m=>b(m,l)},null,8,["onClick"])],40,$e))),128))],40,Pe)]),_:2},1024))),128)),o(U,null,{header:_(()=>[s("div",{class:"flex align-items-center w-full px-3 py-2",draggable:"true",onDrop:e[6]||(e[6]=a=>w(a,"none")),onDragover:e[7]||(e[7]=i(()=>{},["prevent"])),onDragenter:e[8]||(e[8]=i(()=>{},["prevent"]))},[Ue,Re,Ae,o(d,{icon:"mdi mdi-plus-thick",label:t.$t("charactersPage.createNewCharacterButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:i(E,["stop"])},null,8,["label","onClick"])],32)]),default:_(()=>[s("div",{onDrop:e[9]||(e[9]=a=>w(a,t.group)),onDragover:e[10]||(e[10]=i(()=>{},["prevent"])),onDragenter:e[11]||(e[11]=i(()=>{},["prevent"]))},[(c(!0),v(P,null,$(z.value,a=>(c(),v("div",{key:a.id,class:"character-entry py-2 mt-2",draggable:"true",onClick:l=>N(l,a.id),onDragstart:l=>L(l,a.id)},[s("div",je,[s("div",Fe,[a.class?(c(),x(D,{key:0,class:"class-image",src:`https://tmktahu.github.io/WakfuAssets/classes/${a.class}.png`,"image-style":"width: 40px"},null,8,["src"])):(c(),x(D,{key:1,class:"class-image",src:C(S),"image-style":"width: 40px"},null,8,["src"]))]),o(r,{class:"mx-2",layout:"vertical"}),s("div",Ge,u(a.name),1),o(r,{class:"mx-2",layout:"vertical"}),s("div",Oe,"Lvl "+u(a.level),1),o(r,{class:"mx-2",layout:"vertical"}),o(d,{class:"by-level-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:l=>b(l,a.id)},null,8,["onClick"])]),s("div",qe,[o(A,{character:a,"read-only":""},null,8,["character"])]),o(d,{class:"at-end-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:l=>b(l,a.id)},null,8,["onClick"])],40,Se))),128))],32)]),_:1})]),_:1},8,["active-index"])])])])}}},Je=Q(We,[["__scopeId","data-v-e9011152"]]);export{Je as default};
