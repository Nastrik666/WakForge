import{O as b,_ as ee,v as ne,i as V,r as W,f as P,a1 as Z,a2 as K,g as I,o as i,n as E,w as $,j as a,k as p,t as w,q as A,N as te,h as o,F as C,m as T,l as q,K as se,s as le,x as ie,b as oe,a as ue,D as ce,E as re,G as U}from"./index-f7b3d347.js";import{I as de}from"./ItemStatList-859635e0.js";const pe=()=>{const g=y=>{let f=O(y),v="https://www.wakfu.com/en/mmorpg/encyclopedia",r="";return y.type.validSlots.includes(b.FIRST_WEAPON.id)||y.type.validSlots.includes(b.SECOND_WEAPON.id)?r=`${v}/weapons/${f}`:y.type.validSlots.includes(b.PET.id)?r=`${v}/pets/${f}`:y.type.validSlots.includes(b.MOUNT.id)?r=`${v}/mounts/${f}`:y.type.validSlots.includes(b.ACCESSORY.id)?r=`${v}/accessories/${f}`:r=`${v}/armors/${f}`,r},O=y=>{let f=y.id,v=y.name.toLowerCase().replace(" ","-");return`${f}-${v}`};return{getItemEncyclopediaUrl:g}};const ae=g=>(le("data-v-76befabf"),g=g(),ie(),g),me=ae(()=>a("div",{class:"drag-bar"},null,-1)),ve={class:"edit-item-modal-content flex flex-column pb-2"},_e={class:"header-area flex px-3 pt-2 pb-1"},he={class:"flex flex-column ml-1"},ye={class:"item-name mr-2 truncate",style:{"max-width":"15ch"}},fe={class:"flex"},ge={key:0},ke={key:1},xe=ae(()=>a("div",{class:"flex-grow-1"},null,-1)),be={key:0,class:"random-mastery-section flex flex-column px-3"},Se={class:"text-center w-full text-lg mb-2 pt-2"},$e={class:"flex justify-content-center gap-2 px-3"},Ee={key:0,class:"flex align-items-center"},we={key:1},Ae={class:"flex align-items-center py-1 px-2"},Ce={class:"capitalize"},Ie={key:1,class:"random-resistance-section flex flex-column px-3"},We={class:"text-center w-full text-lg mb-2 pt-2"},Oe={class:"flex justify-content-center gap-2 px-3"},Ne={key:0,class:"flex align-items-center"},Re={key:1},Te={class:"flex align-items-center py-1 px-2"},qe={class:"capitalize"},De={class:"flex justify-content-center mt-2"},Le={__name:"EditEquipmentModal",setup(g,{expose:O}){let y=ne();const f=V("currentCharacter"),v=W(!1),r=W(null),n=W({}),k=[{value:"empty",label:"None",icon:"empty_coin"},{value:"water",label:"Water",icon:"water_coin"},{value:"earth",label:"Earth",icon:"earth_coin"},{value:"air",label:"Air",icon:"air_coin"},{value:"fire",label:"Fire",icon:"fire_coin"}],S=P(()=>{var s,e;return(e=(s=r.value)==null?void 0:s.equipEffects)==null?void 0:e.find(t=>t.id===1068)}),_=P(()=>{var s,e;return(e=(s=r.value)==null?void 0:s.equipEffects)==null?void 0:e.find(t=>t.id===1069)});Z.on(K.UPDATE_RAND_ELEM_SELECTORS,()=>{u(),L()});const u=()=>{v.value&&S.value!==void 0&&(n.value.masterySlot1=k.find(s=>{var e;return s.value===((e=S.value.masterySlot1)==null?void 0:e.type)}),n.value.masterySlot2=k.find(s=>{var e;return s.value===((e=S.value.masterySlot2)==null?void 0:e.type)}),n.value.masterySlot3=k.find(s=>{var e;return s.value===((e=S.value.masterySlot3)==null?void 0:e.type)}))},L=()=>{v.value&&_.value!==void 0&&(n.value.resistanceSlot1=k.find(s=>{var e,t;return s.value===((t=(e=_.value)==null?void 0:e.resistanceSlot1)==null?void 0:t.type)}),n.value.resistanceSlot2=k.find(s=>{var e,t;return s.value===((t=(e=_.value)==null?void 0:e.resistanceSlot2)==null?void 0:t.type)}),n.value.resistanceSlot3=k.find(s=>{var e,t;return s.value===((t=(e=_.value)==null?void 0:e.resistanceSlot3)==null?void 0:t.type)}))},M=(s,e)=>{var c,x;let t=(x=(c=r.value)==null?void 0:c.equipEffects)==null?void 0:x.find(l=>l.id===1068);t[e]={type:n.value[e].value,value:S.value.values[0]},Object.keys(t).forEach(l=>{var m;l!==e&&((m=t[l])==null?void 0:m.type)===n.value[e].value&&(t[l]={type:k[0].value,value:[]},n.value[l]=k[0])})},j=()=>{Object.keys(n.value).forEach(s=>{var e,t;if(n.value[s]){let c=(t=(e=r.value)==null?void 0:e.equipEffects)==null?void 0:t.find(x=>x.id===1069);c[s]={type:n.value[s].value,value:_.value.values[0]}}})},N=()=>{Object.keys(f.value.equipment).forEach(s=>{f.value.equipment[s]!==null&&f.value.equipment[s].equipEffects.forEach(e=>{var t,c,x,l,m,d;e.id===1068&&S.value&&(e.values[2]>=1&&(e.masterySlot1={type:((t=n.value.masterySlot1)==null?void 0:t.value)||"empty",value:e.values[0]}),e.values[2]>=2&&(e.masterySlot2={type:((c=n.value.masterySlot2)==null?void 0:c.value)||"empty",value:e.values[0]}),e.values[2]>=3&&(e.masterySlot3={type:((x=n.value.masterySlot3)==null?void 0:x.value)||"empty",value:e.values[0]})),e.id===1069&&_.value&&(e.values[2]>=1&&(e.resistanceSlot1={type:((l=n.value.resistanceSlot1)==null?void 0:l.value)||"empty",value:e.values[0]}),e.values[2]>=2&&(e.resistanceSlot2={type:((m=n.value.resistanceSlot2)==null?void 0:m.value)||"empty",value:e.values[0]}),e.values[2]>=3&&(e.resistanceSlot3={type:((d=n.value.resistanceSlot3)==null?void 0:d.value)||"empty",value:e.values[0]}))})}),Z.emit(K.UPDATE_RAND_ELEM_SELECTORS)},R=(s,e,t)=>{r.value=f.value.equipment[s],v.value=!0,se(()=>{let c=document.getElementById(y);c.style.position="fixed",c.style.left=`${e}px`,c.style.top=`${t}px`,u(),L()})},B=()=>{v.value=!1};return O({open:R}),(s,e)=>{const t=I("p-image"),c=I("p-button"),x=I("p-dropdown"),l=I("p-dialog");return i(),E(l,{id:A(y),visible:v.value,"onUpdate:visible":e[0]||(e[0]=m=>v.value=m)},{header:$(()=>[me]),default:$(()=>[a("div",ve,[a("div",_e,[p(t,{src:`https://tmktahu.github.io/WakfuAssets/items/${r.value.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),a("div",he,[a("div",ye,w(r.value.name),1),a("div",fe,[p(t,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/rarities/${r.value.rarity}.png`,"image-style":"width: 12px;"},null,8,["src"]),p(t,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/itemTypes/${r.value.type.id}.png`,"image-style":"width: 18px;"},null,8,["src"]),A(te).includes(r.value.type.id)?(i(),o("div",ge,"Item Level: 50")):(i(),o("div",ke,"Level: "+w(r.value.level),1))])]),xe,p(c,{class:"close-button px-1 py-1",icon:"mdi mdi-close-thick",onClick:B})]),S.value?(i(),o("div",be,[a("div",Se,"+"+w(S.value.values[0])+" Mastery Assignment",1),a("div",$e,[(i(!0),o(C,null,T(S.value.values[2],m=>(i(),E(x,{key:m,modelValue:n.value["masterySlot"+m],"onUpdate:modelValue":d=>n.value["masterySlot"+m]=d,class:"mastery-dropdown","option-label":"label",options:k,onChange:d=>M(d,"masterySlot"+m)},{value:$(d=>[d.value?(i(),o("div",Ee,[p(t,{src:`https://tmktahu.github.io/WakfuAssets/statistics/${d.value.icon}.png`,style:{height:"40px"},"image-style":"height: 40px; margin-top: -1px"},null,8,["src"])])):(i(),o("span",we,[p(t,{src:"https://tmktahu.github.io/WakfuAssets/statistics/empty_coin.png",style:{height:"36px"},"image-style":"height: 36px; margin-top: 1px; margin-left: 2px"},null,8,["src"])]))]),option:$(d=>[a("div",Ae,[a("div",Ce,w(d.option.label),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]))),128))])])):q("",!0),_.value?(i(),o("div",Ie,[a("div",We,"+"+w(_.value.values[0])+" Resistance Assignment",1),a("div",Oe,[(i(!0),o(C,null,T(_.value.values[2],m=>(i(),E(x,{key:m,modelValue:n.value["resistanceSlot"+m],"onUpdate:modelValue":d=>n.value["resistanceSlot"+m]=d,class:"mastery-dropdown",options:k,"option-label":"label",onChange:j},{value:$(d=>[d.value?(i(),o("div",Ne,[p(t,{src:`https://tmktahu.github.io/WakfuAssets/statistics/${d.value.icon}.png`,style:{height:"40px"},"image-style":"height: 40px; margin-top: -1px"},null,8,["src"])])):(i(),o("span",Re,[p(t,{src:"https://tmktahu.github.io/WakfuAssets/statistics/empty_coin.png",style:{height:"36px"},"image-style":"height: 36px; margin-top: 1px; margin-left: 2px"},null,8,["src"])]))]),option:$(d=>[a("div",Te,[a("div",qe,w(d.option.label),1)])]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))])])):q("",!0),a("div",De,[p(c,{class:"py-2",label:"Apply to all Items",onClick:N})])])]),_:1},8,["id","visible"])}}},Me=ee(Le,[["__scopeId","data-v-76befabf"]]);const D=g=>(le("data-v-7cd33f43"),g=g(),ie(),g),je={class:"flex equipment-slots-wrapper"},Be={key:0,class:"flex align-items-center justify-content-center"},Ue={key:1,class:"flex align-items-center justify-content-center"},Ve={class:"flex align-items-center justify-content-center"},Pe=D(()=>a("div",{class:"hover-icon search"},[a("i",{class:"pi pi-search"})],-1)),Fe={class:"flex align-items-center justify-content-center w-full",style:{position:"relative"}},ze=["onClick"],Ge=D(()=>a("i",{class:"pi pi-pencil"},null,-1)),Ye=[Ge],He=["onClick"],Je=D(()=>a("i",{class:"pi pi-trash"},null,-1)),Qe=[Je],Xe={key:0,class:"random-stat-icons-wrapper"},Ze={key:1,class:"random-stat-icons-wrapper"},Ke={key:0,class:"item-card-tooltip"},et={class:"effect-header flex pt-2 px-1"},tt={class:"flex flex-column"},st={class:"item-name mr-2"},lt={class:"flex"},it={key:0},at={key:1},nt=D(()=>a("div",{class:"flex-grow-1"},null,-1)),ot={class:"flex"},ut=D(()=>a("div",{class:"simple-tooltip"},"Open Encyclopedia Page",-1)),ct={__name:"EquipmentButtons",props:{character:{type:Object,default:()=>{}},readOnly:{type:Boolean,default:!1}},setup(g){const{t:O}=oe();let y=g;const f=ue(),{getItemEncyclopediaUrl:v}=pe(),r=V("itemFilters"),n=W(null),k=P(()=>{let s=_.value.equipment[b.FIRST_WEAPON.id];return s?!!s.type.disabledSlots.includes(b.SECOND_WEAPON.id):!1}),S=V("masterData"),_=W(y.character),u=W({});ce(S,re.debounce(()=>{se(()=>{var s;_.value=y.character,u.value=(s=_.value)==null?void 0:s.equipment})},100),{immediate:!0});const L=s=>{r.itemTypeFilters.forEach(e=>{e.validSlots.includes(b[s])?e.checked=!0:e.checked=!1})},M=(s,e,t)=>{n.value[s].open(e,t.target.getBoundingClientRect().left-200,t.target.getBoundingClientRect().bottom+10)},j=(s,e)=>{f.require({group:"popup",target:e.currentTarget,message:O("confirms.areYouSure"),accept:()=>{_.value.equipment[s]=null}})},N=s=>{var e,t;return((t=(e=_.value.equipment[s])==null?void 0:e.equipEffects)==null?void 0:t.find(c=>c.id===1068))||null},R=s=>{var e,t;return((t=(e=_.value.equipment[s])==null?void 0:e.equipEffects)==null?void 0:t.find(c=>c.id===1069))||null},B=s=>{let e=v(s);window.open(e,"_blank")};return(s,e)=>{const t=I("p-image"),c=I("p-button"),x=I("tippy");return i(),o("div",je,[(i(!0),o(C,null,T(A(b),(l,m,d)=>{var F,z;return i(),o(C,{key:l.id},[g.readOnly?(i(),o("div",{key:0,class:U(["equipment-display",{"has-item":u.value[l.id]!==null}])},[(F=u.value[l.id])!=null&&F.imageId?(i(),o("div",Be,[p(t,{src:`https://tmktahu.github.io/WakfuAssets/items/${(z=u.value[l.id])==null?void 0:z.imageId}.png`,"image-style":"width: 40px"},null,8,["src"])])):(i(),o("div",Ue,[p(t,{src:`https://tmktahu.github.io/WakfuAssets/equipmentDefaults/${l.id}.png`,"image-style":"width: 60px"},null,8,["src"])]))],2)):(i(),o(C,{key:1},[u.value[l.id]===null||u.value[l.id]===void 0?(i(),E(c,{key:0,class:U(["equipment-button",{"has-item":u.value[l.id]!==null,disabled:l.id===A(b).SECOND_WEAPON.id&&k.value}]),onClick:h=>L(l.id)},{default:$(()=>{var h;return[a("div",Ve,[Pe,l.id===A(b).SECOND_WEAPON.id&&k.value?(i(),E(t,{key:0,class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/items/${(h=u.value[A(b).FIRST_WEAPON.id])==null?void 0:h.imageId}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),E(t,{key:1,class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/equipmentDefaults/${l.id}.png`,"image-style":"width: 60px"},null,8,["src"]))])]}),_:2},1032,["class","onClick"])):(i(),E(x,{key:1,placement:"bottom",interactive:"",duration:"0"},{content:$(()=>{var h,G,Y,H,J,Q,X;return[u.value[l.id]?(i(),o("div",Ke,[a("div",et,[p(t,{src:`https://tmktahu.github.io/WakfuAssets/items/${(h=u.value[l.id])==null?void 0:h.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),a("div",tt,[a("div",st,w(s.$t(`items.${u.value[l.id].id}`)),1),a("div",lt,[p(t,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/rarities/${(G=u.value[l.id])==null?void 0:G.rarity}.png`,"image-style":"width: 12px;"},null,8,["src"]),p(t,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/itemTypes/${(H=(Y=u.value[l.id])==null?void 0:Y.type)==null?void 0:H.id}.png`,"image-style":"width: 18px;"},null,8,["src"]),A(te).includes((Q=(J=u.value[l.id])==null?void 0:J.type)==null?void 0:Q.id)?(i(),o("div",it,"Item Level: 50")):(i(),o("div",at,"Level: "+w((X=u.value[l.id])==null?void 0:X.level),1))])]),nt,a("div",ot,[p(x,{placement:"left"},{content:$(()=>[ut]),default:$(()=>[p(c,{icon:"pi pi-question-circle",class:"equip-button",onClick:rt=>B(u.value[l.id])},null,8,["onClick"])]),_:2},1024)])]),p(de,{item:u.value[l.id]},null,8,["item"])])):q("",!0)]}),default:$(()=>[a("div",{class:U(["equipment-button",{"has-item":u.value[l.id]!==null}])},[a("div",Fe,[a("div",{class:"hover-icon edit",onClick:h=>M(d,l.id,h)},Ye,8,ze),a("div",{class:"hover-icon remove",onClick:h=>j(l.id,h)},Qe,8,He),p(t,{class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/items/${u.value[l.id].imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),N(l.id)!==null?(i(),o("div",Xe,[(i(!0),o(C,null,T(N(l.id).values[2],h=>(i(),E(t,{key:h,src:`https://tmktahu.github.io/WakfuAssets/statistics/${N(l.id)[`masterySlot${h}`].type}_coin.png`,"image-style":"width: 16px"},null,8,["src"]))),128))])):q("",!0),R(l.id)!==null?(i(),o("div",Ze,[(i(!0),o(C,null,T(R(l.id).values[2],h=>(i(),E(t,{key:h,src:`https://tmktahu.github.io/WakfuAssets/statistics/${R(l.id)[`resistanceSlot${h}`].type}_coin.png`,"image-style":"width: 16px"},null,8,["src"]))),128))])):q("",!0)])],2)]),_:2},1024)),p(Me,{ref_for:!0,ref_key:"editEquipmentModal",ref:n},null,512)],64))],64)}),128))])}}},mt=ee(ct,[["__scopeId","data-v-7cd33f43"]]);export{mt as E,pe as u};
