import{_ as Z,u as ee,a as te,b as se,c as ae,i as le,r as oe,d as re,e as ne,f as S,g as h,o as i,h as v,j as s,t as p,k as o,l as ce,w as _,m as C,C as I,v as ie,F as P,n as $,p as x,q as d,s as de,x as ue}from"./index-6034c5b2.js";import{E as j}from"./EquipmentButtons-a36caa7d.js";import{a as F}from"./addCompanion-f6ce7806.js";import"./ItemStatList-0545c6a0.js";const f=k=>(de("data-v-6f25c35c"),k=k(),ue(),k),pe={class:"flex flex-column flex-grow-1 ml-4 mr-3",style:{height:"100%",overflow:"hidden"}},me={class:"mt-3",style:{"font-size":"42px"}},he={class:"mt-2"},ve={class:"flex align-items-center w-full"},_e={class:"text-xl mr-3"},fe={key:0,class:"mt-2",style:{color:"var(--error)"}},ge={class:"character-area"},ye={class:"flex w-full"},Ce={class:"text-xl"},xe=f(()=>s("div",{class:"flex-grow-1"},null,-1)),ke={class:"character-enties-wrapper flex flex-column mt-2 pb-3"},be=["onDrop"],we=f(()=>s("i",{class:"mdi mdi-folder"},null,-1)),De={class:"flex"},Be={class:"mx-2"},Ie=f(()=>s("i",{class:"mdi mdi-pencil"},null,-1)),Pe={class:"px-3"},$e=f(()=>s("div",{class:"flex-grow-1"},null,-1)),Te=["onDrop"],Ve=["onClick","onDragstart"],Ee={class:"character-info flex align-items-center justify-content-left flex-grow-1"},Ne={class:"ml-3"},Le={class:"class-name flex-grow-1 truncate"},Ue={class:"class-level"},Re={class:"character-items flex-grow-1"},Ae=f(()=>s("i",{class:"mdi mdi-folder"},null,-1)),Se=f(()=>s("div",{class:"mx-2"},"Ungrouped",-1)),je=f(()=>s("div",{class:"flex-grow-1"},null,-1)),Fe=["onClick","onDragstart"],Ge={class:"character-info flex align-items-center justify-content-left flex-grow-1"},Oe={class:"ml-3"},qe={class:"class-name flex-grow-1 truncate"},We={class:"class-level"},ze={class:"character-items flex-grow-1"},He={__name:"CharactersPage",setup(k){const G=ee(),O=te(),{t:T}=se(),B=ae(),n=le("masterData"),g=oe(""),{decodeBuildCode:q}=re(),{createNewCharacter:W,createNewCharacterFromCode:z,deleteCharacter:H}=ne(n),V=S(()=>q(g.value)!==null),M=S(()=>{var r;let t=[];return(r=n.groups)==null||r.forEach(c=>{t.push(...c.buildIds)}),n.characters.filter(c=>!t.includes(c.id))}),E=t=>{let e=W();t.buildIds.push(e.id),B.push({name:I,params:{characterId:e.id}})},Y=()=>{let t=z(g.value);B.push({name:I,params:{characterId:t.id}})},J=()=>{n.groups.push({id:ie(),name:T("charactersPage.newGroup"),buildIds:[]})},K=t=>{if(t.buildIds.length===0){let e=n.groups.indexOf(t);n.groups.splice(e,1)}else G.add({severity:"error",summary:"You cannot delete a group that has characters in it.",life:3e3})},b=(t,e)=>{O.require({group:"popup",target:t.currentTarget,message:T("confirms.irreversable"),accept:()=>{n.groups.forEach(r=>{if(r.buildIds.includes(e)){let c=r.buildIds.indexOf(e);r.buildIds.splice(c,1)}}),H(e)}})},N=(t,e)=>{t.target.classList.contains("delete-button")||B.push({name:I,params:{characterId:e}})},y=t=>n.characters.find(e=>e.id===t),L=(t,e)=>{t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("buildId",e)},w=(t,e)=>{try{let r=t.dataTransfer.getData("buildId");n.groups.forEach(c=>{if(c.buildIds.includes(r)){let u=c.buildIds.indexOf(r);c.buildIds.splice(u,1)}}),e!=="none"&&e.buildIds.push(r)}catch{}};return(t,e)=>{var R,A;const r=h("p-divider"),c=h("p-inputText"),u=h("p-button"),Q=h("p-inplace"),D=h("p-image"),U=h("p-accordionTab"),X=h("p-accordion");return i(),v("div",pe,[s("div",me,p(t.$t("charactersPage.title")),1),s("div",he,p(t.$t("charactersPage.description")),1),o(r),s("div",null,[s("div",ve,[s("div",_e,p(t.$t("charactersPage.codeInputLabel"))+":",1),o(c,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),placeholder:t.$t("charactersPage.codeInputPlaceholder"),class:"flex-grow-1 py-2"},null,8,["modelValue","placeholder"]),o(u,{icon:"mdi mdi-plus-thick",disabled:!V.value,label:t.$t("charactersPage.codeInputButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:Y},null,8,["disabled","label"])]),!V.value&&g.value!==""?(i(),v("div",fe,p(t.$t("charactersPage.invalidBuildCode")),1)):ce("",!0)]),o(r),s("div",ge,[s("div",ye,[s("div",Ce,p(t.$t("charactersPage.savedCharactersTitle")),1),xe,o(u,{icon:"mdi mdi-folder",label:t.$t("charactersPage.createNewGroupButton"),class:"create-character-button py-1 pr-3 pl-2",onClick:J},null,8,["label"])]),s("div",ke,[o(X,{multiple:"","active-index":[...(R=C(n).groups)==null?void 0:R.keys(),(A=C(n).groups)==null?void 0:A.length]},{default:_(()=>[(i(!0),v(P,null,$(C(n).groups,a=>(i(),x(U,{key:a.id},{header:_(()=>[s("div",{class:"flex align-items-center w-full px-3 py-2",onDrop:l=>w(l,a),onDragover:e[2]||(e[2]=d(()=>{},["prevent"])),onDragenter:e[3]||(e[3]=d(()=>{},["prevent"]))},[we,o(Q,{closable:!0,pt:{content:{class:"flex align-items-center"},button:{class:"py-1"}},onClick:e[1]||(e[1]=d(()=>{},["stop"]))},{display:_(()=>[s("div",De,[s("div",Be,p(a.name),1),Ie])]),content:_(()=>[s("div",Pe,[o(c,{modelValue:a.name,"onUpdate:modelValue":l=>a.name=l,class:"py-1",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024),$e,o(u,{icon:"mdi mdi-plus-thick",label:t.$t("charactersPage.createNewCharacterButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:d(l=>E(a),["stop"])},null,8,["label","onClick"]),o(u,{icon:"pi pi-trash",class:"ml-3 py-1",onClick:d(l=>K(a),["stop"])},null,8,["onClick"])],40,be)]),default:_(()=>[s("div",{onDrop:l=>w(l,a),onDragover:e[4]||(e[4]=d(()=>{},["prevent"])),onDragenter:e[5]||(e[5]=d(()=>{},["prevent"]))},[(i(!0),v(P,null,$(a.buildIds,l=>(i(),v("div",{key:l,class:"character-entry py-2 mt-2",draggable:"true",onClick:m=>N(m,l),onDragstart:m=>L(m,l)},[s("div",Ee,[s("div",Ne,[y(l).class?(i(),x(D,{key:0,class:"class-image",src:`https://tmktahu.github.io/WakfuAssets/classes/${y(l).class}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),x(D,{key:1,class:"class-image",src:C(F),"image-style":"width: 40px"},null,8,["src"]))]),o(r,{class:"mx-2",layout:"vertical"}),s("div",Le,p(y(l).name),1),o(r,{class:"mx-2",layout:"vertical"}),s("div",Ue,"Lvl "+p(y(l).level),1),o(r,{class:"mx-2",layout:"vertical"}),o(u,{class:"by-level-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:m=>b(m,l)},null,8,["onClick"])]),s("div",Re,[o(j,{character:y(l),"read-only":""},null,8,["character"])]),o(u,{class:"at-end-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:m=>b(m,l)},null,8,["onClick"])],40,Ve))),128))],40,Te)]),_:2},1024))),128)),o(U,null,{header:_(()=>[s("div",{class:"flex align-items-center w-full px-3 py-2",draggable:"true",onDrop:e[6]||(e[6]=a=>w(a,"none")),onDragover:e[7]||(e[7]=d(()=>{},["prevent"])),onDragenter:e[8]||(e[8]=d(()=>{},["prevent"]))},[Ae,Se,je,o(u,{icon:"mdi mdi-plus-thick",label:t.$t("charactersPage.createNewCharacterButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:d(E,["stop"])},null,8,["label","onClick"])],32)]),default:_(()=>[s("div",{onDrop:e[9]||(e[9]=a=>w(a,t.group)),onDragover:e[10]||(e[10]=d(()=>{},["prevent"])),onDragenter:e[11]||(e[11]=d(()=>{},["prevent"]))},[(i(!0),v(P,null,$(M.value,a=>(i(),v("div",{key:a.id,class:"character-entry py-2 mt-2",draggable:"true",onClick:l=>N(l,a.id),onDragstart:l=>L(l,a.id)},[s("div",Ge,[s("div",Oe,[a.class?(i(),x(D,{key:0,class:"class-image",src:`https://tmktahu.github.io/WakfuAssets/classes/${a.class}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),x(D,{key:1,class:"class-image",src:C(F),"image-style":"width: 40px"},null,8,["src"]))]),o(r,{class:"mx-2",layout:"vertical"}),s("div",qe,p(a.name),1),o(r,{class:"mx-2",layout:"vertical"}),s("div",We,"Lvl "+p(a.level),1),o(r,{class:"mx-2",layout:"vertical"}),o(u,{class:"by-level-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:l=>b(l,a.id)},null,8,["onClick"])]),s("div",ze,[o(j,{character:a,"read-only":""},null,8,["character"])]),o(u,{class:"at-end-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:l=>b(l,a.id)},null,8,["onClick"])],40,Fe))),128))],32)]),_:1})]),_:1},8,["active-index"])])])])}}},Qe=Z(He,[["__scopeId","data-v-6f25c35c"]]);export{Qe as default};
